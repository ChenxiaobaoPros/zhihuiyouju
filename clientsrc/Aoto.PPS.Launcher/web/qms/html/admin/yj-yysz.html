<!DOCTYPE>
<html lang="en">
<head>
    <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Free HTML5 Bootstrap Admin Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Charisma, a fully featured, responsive, HTML5, Bootstrap admin template.">
    <meta name="author" content="Muhammad Usman">

    <!-- The styles -->
    <link href="../../css/bootstrap-11.min.css" rel="stylesheet">
    <link href="../../css/charisma-app.css" rel="stylesheet">
    <link href='../../css/chosen.min.css' rel='stylesheet'>
    <link href='../../css/colorbox.css' rel='stylesheet'>
    <link href='../../css/responsive-tables.css' rel='stylesheet'>
    <link href='../../css/bootstrap-tour.min.css' rel='stylesheet'>
    <link href='../../css/jquery.noty.css' rel='stylesheet'>
    <link href='../../css/noty_theme_default.css' rel='stylesheet'>
    <link href='../../css/elfinder.min.css' rel='stylesheet'>
    <link href='../../css/elfinder.theme.css' rel='stylesheet'>
    <link href='../../css/jquery.iphone.toggle.css' rel='stylesheet'>
    <link href='../../css/uploadify.css' rel='stylesheet'>
    <link href='../../css/animate.min.css' rel='stylesheet'>
    <link href='../../css/bootstrap-datetimepicker.css' rel='stylesheet'>
    <link rel="stylesheet"  href="../../css/icheck/yellow.css"/>
  	<link rel="stylesheet"  href="../../css/button.css"/>
  	<link rel="stylesheet"  href="../../css/common.css"/>

    <!-- The HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- jQuery -->
	<script type="text/javascript" src="../../js/lib/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="../../js/lib/jquery/plugins/jquery.string.js"></script>
	<script type="text/javascript" src="../../js/lib/jquery/plugins/jquery.json.js"></script>
	<script type="text/javascript" src="../../js/lib/easyui/plugins/jquery.draggable.js"></script>
	<script type="text/javascript" src="../../js/lib/easyui/plugins/jquery.parser.js"></script>
    <script type="text/javascript" src="../../../js/peripheral.js"></script>
	<script type="text/javascript" src="../../js/map.js"></script>
	<script src="../../js/lib/jquery/icheck/jquery.icheck.js" type="text/javascript" ></script>
	<script type="text/javascript" src="../../js/bootbox.js"></script>
 
    <!-- The fav icon -->
    <link rel="shortcut icon" href="../../images/favicon.ico">

</head>
<style>
	.active-result{
		color: black;
	}
	.form-label-input{
		float: left;
		margin-left:10px ;
	}
	.floatinput{
		float: left;
	}
</style>
<body>
	<div id="loading1">
		<div>
			<image src='../../js/lib/easyui/themes/default/images/loading.gif' />  正在处理，请稍等...
		</div>
	</div>
<form id="frm">
<div class="ch-container" id="container" style="display:none;">
    <div class="row" >
        
        <noscript>
            <div class="alert alert-block col-md-12">
                <h4 class="alert-heading">Warning!</h4>
            </div>
        </noscript>

        <div id="content" class="col-lg-12 col-sm-12">
            <!-- content starts -->
	<div class="row">
        <div class="box col-md-12">
            <div class="box-inner">
                <div class="box-header well">
                    <h2><i class="glyphicon glyphicon-info-sign"></i>语音内容</h2>

                    <div class="box-icon">
                        <a href="#" class="btn btn-minimize btn-round btn-default"><i
                                class="glyphicon glyphicon-chevron-up"></i></a>
                    </div>
                </div>
                <div class="box-content">
                <table class="table table-bordered responsive">
                     
                        <tbody>
                        	<tr>
								<td  class="td-right">
									<div class="form-label">语音呼叫次数</div>
								</td>
								<td  >
									<div class="controls">
										<select name="soundSpeakTimes" id="soundSpeakTimes">
											<option value="1" selected="selected">1</option>
											<option value="2">2</option>
											<option value="3">3</option>
										</select>
									</div>
								</td>

							</tr>
                        	<tr>
								<td class="td-right">
									<div class="form-label">所有业务使用相同语言播放</div>
								</td>
								<td >
									<div class="controls">
										<input type="checkbox" id="useSameLanSpeakFlag" name="useSameLanSpeakFlag"/>
									</div>
								</td>							
							</tr>
							<tr>
								<td class="td-right">
									<div class="form-label">是否贵宾室窗口使用“贵宾室”语音</div>
								</td>
								<td >
									<div class="controls">
										<input type="checkbox" id="vipWinSoundFlag" name="vipWinSoundFlag"/>
									</div>
								</td>							
							</tr>
							<tr>
								<td  class="td-right">
									<div class="form-label">播放语言</div>
								</td>
								<td  >
									<div class="controls form-label-input">
										<span class="form-label-input">中文</span><div class="floatinput form-label-input"><input type="checkbox" id="speakLanguage1" name="speakLanguage1" class="form-control"/></div>
									</div>
									<div class="controls form-label-input">
										<span class="form-label-input">英文</span><div class="floatinput form-label-input"><input type="checkbox" id="speakLanguage2" name="speakLanguage2" class="form-control"/></div>
									</div>
									<div class="controls form-label-input">
										<span class="form-label-input">粤语</span><div class="floatinput form-label-input"><input type="checkbox" id="speakLanguage3" name="speakLanguage3" class="form-control"/></div>
									</div>
									
								</td>
							</tr>
                        </tbody>
                    </table>
               </div>
            </div>
        </div>
        <!--/span-->
    </div><!--/row-->

    <!-- content ends -->
    </div><!--/#content.col-md-0-->
</div><!--/fluid-row-->
    <div class="row">
        <div class="box col-md-12">
            <div class="box-inner">
                <div class="box-content">
                	<p class="center" style="margin-bottom: 0px;">
						<input type="submit" class="btn btn-primary btn-custom" id="saveConfig" value="保存">
												
					</p>
					
               </div>
            </div>
        </div>
        <!--/span-->
    </div><!--/row-->

</div><!--/.fluid-container-->
</form>
<!-- external javascript -->

<script src="../../js/bootstrap.min.js"></script>

<!-- library for cookie management -->
<script src="../../js/jquery.cookie.js"></script>
<!-- data table plugin -->
<script src='../../js/jquery.dataTables.min.js'></script>

<!-- select or dropdown enhancer -->
<script src="../../js/chosen.jquery.min.js"></script>
<!-- plugin for gallery image view -->
<script src="../../js/jquery.colorbox-min.js"></script>
<!-- notification plugin -->
<script src="../../js/jquery.noty.js"></script>
<!-- library for making tables responsive -->
<script src="../../js/responsive-tables.js"></script>
<!-- tour plugin -->
<script src="../../js/bootstrap-tour.min.js"></script>
<!-- star rating plugin -->
<script src="../../js/jquery.raty.min.js"></script>
<!-- for iOS style toggle switch -->
<script src="../../js/jquery.iphone.toggle.js"></script>
<!-- autogrowing textarea plugin -->
<script src="../../js/jquery.autogrow-textarea.js"></script>
<!-- multiple file upload plugin -->
<script src="../../js/jquery.uploadify-3.1.min.js"></script>
<!-- history.js for cross-browser state change on ajax -->
<script src="../../js/jquery.history.js"></script>
<!-- application script for Charisma demo -->
<script src="../../js/charisma.js"></script>
<script type="text/javascript" src="../../js/jquery.metadata.js"></script>
<script type="text/javascript" src="../../js/jquery.validate.js"></script>
<script type="text/javascript" src="../../js/qmsVld.js"></script>

<script type="text/javascript" src="../../../js/lib/date/bootstrap-datetimepicker.js"></script>
<script type="text/javascript" src="../../../js/lib/date/bootstrap-datetimepicker.zh-CN.js"></script>

<script type="text/javascript">

var $qmsIp = $.qms.getCache("qmsIp");
$(function() {
	
	$("input[name='selectTime']").datetimepicker({
		format: 'hh:ii',　　
		language: 'zh-CN',
		minuteStep: 1,
		maxView:0,
		autoclose: true,
		startView:1,
		todayBtn:  1,  
		todayHighlight: 1  
	});
			
	$("input").iCheck({
	checkboxClass: 'icheckbox_minimal-yellow',
	radioClass: 'iradio_minimal-yellow',
	increaseArea: '20%' // optional
	});	

	var args ={};
	args.biom ={};
	args.biom.head ={};
	args.biom.head.tradeCode = "voiceconfig2select";
	args.biom.head.qmsIp = $qmsIp;
	args.biom.body ={};
	args.command=34;
    args.callback="voiceconfig2JSCallback";
    //alert($.toJSON(args));
	$.icbcQms.voiceconfig2JS(args);

	//验证
	$('#frm').validate({
		rules:{
			speakLanguage:{required:true},
			specificWin:{required:true}
		},
		submitHandler: function(form){
			saveConfig();
			return false;
		}
	});
});

//保存
function saveConfig(){
  	//alert("OK");
  	var soundSpeakTimes = $.trim($("#soundSpeakTimes").val());
  	var useSameLanSpeakFlag = $("#useSameLanSpeakFlag").is(':checked');
  	var speakLanguage = $.trim($("#speakLanguage").val());
  	var vipWinSoundFlag = $("#vipWinSoundFlag").is(':checked');
//	var speakSpecificWinFlag = $("#speakSpecificWinFlag").is(':checked');
//	var specificWin = $.trim($("#specificWin").val());

	var args = {};
	args.biom = {};
	args.biom.head = {};
	args.biom.head.tradeCode = "voiceconfig2update";
	args.biom.head.qmsIp = $qmsIp;
	args.biom.body = {};
	args.biom.body.soundSpeakTimes = soundSpeakTimes;
	if(useSameLanSpeakFlag){
		args.biom.body.useSameLanSpeakFlag = "1";
	} else{
		args.biom.body.useSameLanSpeakFlag = "0";
	}
	if(vipWinSoundFlag){
		args.biom.body.vipWinSoundFlag = "1";
	} else{
		args.biom.body.vipWinSoundFlag = "0";
	}

	//播放语言
	var number = -1;
	var combineLanguage = new Array();
	$(".form-label-input input").each(function(e){
		if($(this).is(":checked")){
			number++;
			combineLanguage.push(number);
		} else{
			number++;
		}
	});
	var newConbineLanguage = combineLanguage.join("|");
	if(newConbineLanguage == ""){
		bootbox.alert("请至少选择一项播放语言！");
		$(".modal-content .modal-footer .btn").text("");
	  	$(".modal-content .modal-footer .btn").text("确定");
		return;
	}
	args.biom.body.speakLanguage = newConbineLanguage;
	args.biom.body.speakSpecificWinFlag = "0";
	args.biom.body.specificWin = "0";
	args.callback="voiceconfig2updateCallBack";	
	args.command=33;
	//alert($.toJSON(args));
	$.icbcQms.voiceconfig2JS(args);		  	 
};

function voiceconfig2updateCallBack(args){
	//alert(args);
	var joResult = $.parseJSON(args);
	//alert($.toJSON(joResult));
	if(joResult){
		if(joResult.biom.head.retCode == 0){
			qmsVld.showInfo(joResult.biom.head.retMsg);
		}else{
			qmsVld.showError(joResult.biom.head.retMsg);
		}				
	}

}

function voiceconfig2JSCallback(args){
	//alert(args);
	closeLoading();
	$("#container").css("display","block");
	var joResult = $.parseJSON(args);
	if(joResult){
		
		var retCode = joResult.biom.head.retCode;
		var retMsg = joResult.biom.head.retMsg;
		if(retCode == "1"){
			window.location.href = "timeout.html?retMsg="+retMsg;
		};
		$("#soundSpeakTimes").val(joResult.biom.body.soundSpeakTimes);
		$("#soundSpeakTimes").trigger("chosen:updated");
		$("#soundSpeakTimes").chosen(); 
		$("#soundSpeakTimes").next().css("width","60%");	
		if(joResult.biom.body.useSameLanSpeakFlag == "1"){
	  		$('#useSameLanSpeakFlag').iCheck('check');
	  	}else{
	  		$('#useSameLanSpeakFlag').iCheck('uncheck');
	  	};
	  	if(joResult.biom.body.vipWinSoundFlag == "1"){
	  		$('#vipWinSoundFlag').iCheck('check');
	  	}else{
	  		$('#vipWinSoundFlag').iCheck('uncheck');
	  	};
	  	var speakLanguage= joResult.biom.body.speakLanguage;
	  	if(speakLanguage.indexOf("0")=="-1"){
	  		$('#speakLanguage1').iCheck('uncheck');
	  	}else{
	  		$('#speakLanguage1').iCheck('check');
	  	};
	  	if(speakLanguage.indexOf("1")=="-1"){
	  		$('#speakLanguage2').iCheck('uncheck');
	  	}else{
	  		$('#speakLanguage2').iCheck('check');
	  	};
	  	if(speakLanguage.indexOf("2")=="-1"){
	  		$('#speakLanguage3').iCheck('uncheck');
	  	}else{
	  		$('#speakLanguage3').iCheck('check');
	  	};
//	  	if(joResult.biom.body.speakSpecificWinFlag == "1"){
//	  		$('#speakSpecificWinFlag').iCheck('check');
//	  	}else{
//	  		$('#speakSpecificWinFlag').iCheck('uncheck');
//	  	};
//	  	$("#specificWin").val(joResult.biom.body.specificWin); 	
	}
}


		
</script>

</body>
</html>
